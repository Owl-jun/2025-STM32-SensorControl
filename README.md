# 2025-STM32-SensorControl
다기능 센서 데이터 로거 및 제어 시스템


## 프로젝트 목표

STM32F103 보드 두 개를 사용하여, 다양한 센서 데이터를 수집하고(I2C, SPI), 이를 PC로 전송하거나(UART), 다른 보드로 전달하며(UART, SPI), 
특정 조건에 따라 액추에이터(LED 등)를 제어하는 시스템을 구축합니다.

## 각 통신 프로토콜의 활용 및 학습 목표

### I2C 통신 (센서 데이터 수집)

- HAL 구현: I2C 인터페이스를 가진 센서(예: BMP280 온도/압력 센서, MPU6050 가속도/자이로 센서, DHT11/22 온습도 센서 - 단, DHT는 I2C가 아님)를 

- STM32 마스터 보드에 연결하고, HAL 라이브러리를 사용하여 센서 데이터를 읽어옵니다.
LL 리팩토링: HAL I2C 함수를 LL 드라이버 또는 직접 레지스터 조작 방식으로 변경하여 센서 데이터를 읽어오는 코드를 최적화합니다. I2C 통신의 시작/정지 조건, 주소 지정, ACK/NACK 처리 등을 레지스터 수준에서 이해합니다.

### SPI 통신 (고속 데이터 전송 또는 외부 메모리/디스플레이 제어)
- HAL 구현:

    (보드 간 통신): 한 STM32 보드를 SPI 마스터로, 다른 STM32 보드를 SPI 슬레이브로 설정하여 보드 간에 데이터를 주고받습니다. 
    (예: I2C로 읽은 센서 데이터를 SPI로 다른 보드에 전송)

- LL 리팩토링: 

    HAL SPI 함수를 LL 드라이버 또는 레지스터 직접 조작 방식으로 변경합니다. CPOL/CPHA 설정, 전이중 통신, CS(SS) 핀 제어 등을 레지스터 수준에서 구현하며 최적화합니다.


### UART 통신 (PC 모니터링 및 제어)

- HAL 구현: 

    STM32 보드(마스터)에서 수집한 센서 데이터나 시스템 상태 정보를 UART를 통해 PC로 전송하여 터미널 프로그램(PuTTY, Tera Term 등)에서 모니터링합니다. PC에서 특정 명령을 UART로 전송하여 보드의 LED를 제어하거나 설정을 변경하는 기능을 추가할 수 있습니다.

- LL 리팩토링: 

    HAL UART 함수(송신/수신)를 LL 드라이버 또는 레지스터 직접 조작 방식으로 변경합니다. UART의 보율 설정, 데이터 프레임 구성, 인터럽트 기반 수신 처리 등을 레지스터 수준에서 구현합니다. (ST-Link에 UART 기능이 없으므로, 별도의 USB-to-TTL 컨버터가 필요합니다.)


### FreeRTOS 연동

각 통신 드라이버(HAL 또는 LL로 구현된)를 별도의 FreeRTOS 태스크로 분리합니다.
태스크 간 통신(큐, 세마포어)을 사용하여 센서 데이터 태스크, SPI 전송 태스크, UART 통신 태스크 등을 유기적으로 연결합니다.


<!-- 
## 준비물

STM32F103C8T6 개발 보드 (일명 "Blue Pill"): 2개

프로젝트의 핵심 마이크로컨트롤러 유닛입니다. 보드 간 통신 및 센서/액추에이터 제어에 사용됩니다.

ST-Link V2 디버거/프로그래머: 1개

STM32 보드에 프로그램을 다운로드하고 디버깅하는 데 사용됩니다. (이 케이블에 UART 기능이 없음을 고려)

USB to TTL 시리얼 컨버터: 1개 (필수)

ST-Link 케이블에 UART 기능이 없으므로, STM32 보드의 UART 통신 데이터를 PC의 터미널 프로그램(PuTTY, Tera Term 등)에서 확인하기 위해 반드시 필요합니다.

(예: PL2303HX, CH340G, CP2102 칩셋 기반 모듈)

점퍼선 (Male-to-Male, Male-to-Female, Female-to-Female): 다수

각종 모듈과 보드를 연결하고, 두 보드 간 통신 라인(UART, I2C, SPI)을 연결하는 데 사용됩니다.

브레드보드: 1~2개 (넉넉히)

회로를 임시로 구성하고 부품들을 연결하는 데 필요합니다.

풀업 저항 (4.7kΩ ~ 10kΩ): 최소 4개 (I2C 통신에 필수)

I2C 통신 라인(SDA, SCL)에 각각 2개씩 필요하며, 혹시 모를 다른 풀업이 필요한 상황을 대비하여 여유분을 준비하는 것이 좋습니다.

센서 및 액추에이터 (프로젝트 범위에 따라 선택)
7. I2C 인터페이스 센서: 1~2개 (선택)
* BMP280 (온도/기압 센서): 저렴하고 쉽게 구할 수 있으며, I2C 통신 연습에 좋습니다.
* MPU6050 (3축 가속도/3축 자이로스코프): I2C 통신으로 복잡한 데이터를 읽는 연습에 좋습니다.
* (참고: DHT11/22는 I2C가 아닌 1-Wire 또는 독자적인 프로토콜을 사용하므로 I2C 학습에는 적합하지 않습니다.)

8. LED: 다수 (다양한 색상)
* 액추에이터 제어의 가장 기본적인 요소입니다. 통신 성공 여부 표시, 센서 값에 따른 상태 표시 등에 활용됩니다.
* 저항 (220Ω ~ 330Ω): LED 보호를 위해 필수입니다.

9. SPI 인터페이스 장치: 1개 (선택)
* SD 카드 모듈: SPI 통신을 이용한 데이터 로깅 실습에 매우 유용합니다. (SPI 통신 외에 파일 시스템 이해도 필요)
* SPI OLED/LCD 디스플레이 (예: 0.96인치 SSD1306 OLED): 센서 데이터를 시각적으로 표시하는 데 활용할 수 있습니다.
* AT24C256 (SPI EEPROM): SPI 통신으로 외부 메모리에 데이터를 쓰고 읽는 연습에 적합합니다.

기타 소모품 및 도구
USB Micro-B 케이블: 2개

STM32F103 보드에 전원을 공급하거나, 보드를 PC에 연결하여 프로그램을 다운로드할 때 사용됩니다.

USB Mini-B 케이블: 1개

ST-Link V2와 PC를 연결하는 데 사용됩니다. (일반적으로 ST-Link와 함께 제공)

납땜 인두 및 납 (선택 사항):

모듈이나 핀 헤더가 납땜되지 않은 상태로 제공될 경우 필요합니다.

멀티미터 (선택 사항):

회로의 전압, 전류, 저항 등을 측정하여 문제 해결에 도움을 줍니다.

오실로스코프 또는 로직 분석기 (선택 사항이자 고급):

통신 프로토콜의 신호(전압, 타이밍)를 직접 시각화하여 디버깅하거나, 저수준 구현의 정확성을 검증하는 데 매우 유용합니다. (초기 단계에서는 필수는 아니지만, 깊이 있는 학습에 매우 큰 도움이 됩니다.)
-->


<!--
포트폴리오 어필 포인트:
다양한 통신 프로토콜 숙련도: UART, I2C, SPI 3가지 핵심 통신 프로토콜을 모두 다룬 경험.
하드웨어 제어 능력: HAL과 LL/레지스터 직접 조작을 모두 사용하여 하드웨어에 대한 깊은 이해를 보여줌.
시스템 설계 능력: 센서 데이터 수집, 처리, 전송, 제어 등 임베디드 시스템의 기본적인 구성 요소를 통합하여 구현한 경험.
문제 해결 능력: 저수준 리팩토링 과정에서 발생할 수 있는 문제들을 해결하며 얻은 경험.
실시간 시스템 개발 경험 (FreeRTOS 연동 시): RTOS 환경에서 통신 드라이버를 통합하고 관리하는 능력.
-->